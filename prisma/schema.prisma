generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String   @id @default(cuid())
  email        String   @unique
  passwordHash String
  name         String
  role         UserRole @default(CONTENT_EDITOR)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  blogs        Blog[]

  @@map("users")
}

model Course {
  id          String         @id @default(cuid())
  slug        String         @unique
  title       String
  code        String         @unique
  description String?
  type        CourseType     @default(DIPLOMA)
  duration    String
  eligibility String?
  syllabusUrl String?
  syllabus    Json?
  highlights  String[]
  isActive    Boolean        @default(true)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  category    CourseCategory @default(CS_IT)
  results     Result[]

  @@map("courses")
}

model Faculty {
  id              String   @id @default(cuid())
  slug            String   @unique
  name            String
  designation     String
  department      String
  email           String   @unique
  phone           String?
  photoUrl        String?
  specialization  String?
  qualifications  String[]
  experience      String?
  bio             String?
  teachesDiploma  Boolean  @default(false)
  teachesTraining Boolean  @default(false)
  linkedIn        String?
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@map("faculty")
}

model Notice {
  id            String         @id @default(cuid())
  title         String
  slug          String         @unique
  content       String
  excerpt       String?
  category      NoticeCategory @default(GENERAL)
  attachmentUrl String?
  isPinned      Boolean        @default(false)
  publishedAt   DateTime       @default(now())
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt

  @@index([isPinned, publishedAt])
  @@map("notices")
}

model Result {
  id          String   @id @default(cuid())
  rollNumber  String
  studentName String
  courseId    String
  semester    Int
  sgpa        Float?
  cgpa        Float?
  resultData  Json
  publishedAt DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  course      Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([rollNumber, courseId, semester])
  @@index([rollNumber])
  @@map("results")
}

model Blog {
  id          String    @id @default(cuid())
  title       String
  slug        String    @unique
  content     String
  coverImage  String?
  publishedAt DateTime?
  authorId    String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  excerpt     String?
  isPublished Boolean   @default(false)
  author      User?     @relation(fields: [authorId], references: [id])

  @@index([slug])
  @@index([publishedAt])
  @@index([isPublished])
  @@map("blogs")
}

model Event {
  id               String   @id @default(cuid())
  title            String
  description      String
  date             DateTime
  venue            String
  registrationLink String?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@index([date])
  @@map("events")
}

model Startup {
  id              String        @id @default(cuid())
  slug            String        @unique
  name            String
  type            StartupType   @default(STARTUP)
  sector          String
  description     String
  logoUrl         String?
  websiteUrl      String?
  foundedYear     Int?
  founderNames    String[]
  status          StartupStatus @default(INCUBATING)
  highlights      String[]
  fundingReceived String?
  teamSize        Int?
  isActive        Boolean       @default(true)
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  @@index([type])
  @@index([status])
  @@index([isActive])
  @@map("startups")
}

enum UserRole {
  SUPER_ADMIN
  ACADEMIC_STAFF
  CONTENT_EDITOR
}

enum NoticeCategory {
  GENERAL
  URGENT
  ADMISSION
  EXAM
  RESULT
  EVENT
}

enum CourseType {
  DIPLOMA
  INDUSTRIAL_TRAINING
}

enum CourseCategory {
  CS_IT
  MECHANICAL
  CIVIL
  ELECTRONICS
  MANAGEMENT
  FASHION
  OTHER
}

enum StartupType {
  STARTUP
  COMPANY
}

enum StartupStatus {
  INCUBATING
  ACTIVE
  GRADUATED
}
